{% extends 'base.html' %}

{% block title %}{{ date_str }} - TaskFlow{% endblock %}

{% block content %}
<!-- CSRF Token for AJAX requests -->
<input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
<div class="container mt-4">
    <div class="schedule-container">
        <!-- Header -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h1 class="display-6 mb-1">{{ date_str }}</h1>
                <p class="text-muted mb-0">Daily Schedule & Tasks</p>
            </div>
            <a href="{% url 'home' %}" class="btn btn-outline-secondary">
                <i class="fas fa-calendar me-2"></i>Back to Calendar
            </a>
        </div>

        <!-- Schedule Card -->
        <div class="card shadow">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">
                    <i class="fas fa-clock me-2"></i>Hourly Schedule (4:00 AM - 10:00 PM)
                </h5>
            </div>
            <div class="card-body p-0">
                <!-- Time Slots -->
                {% for hour, task in tasks.items %}
                    <div class="time-slot">
                        <div class="time-label">
                            {% if hour < 12 %}
                                {% if hour == 4 %}4:00 AM{% elif hour == 5 %}5:00 AM{% elif hour == 6 %}6:00 AM{% elif hour == 7 %}7:00 AM{% elif hour == 8 %}8:00 AM{% elif hour == 9 %}9:00 AM{% elif hour == 10 %}10:00 AM{% elif hour == 11 %}11:00 AM{% endif %}
                            {% elif hour == 12 %}
                                12:00 PM
                            {% else %}
                                {% if hour == 13 %}1:00 PM{% elif hour == 14 %}2:00 PM{% elif hour == 15 %}3:00 PM{% elif hour == 16 %}4:00 PM{% elif hour == 17 %}5:00 PM{% elif hour == 18 %}6:00 PM{% elif hour == 19 %}7:00 PM{% elif hour == 20 %}8:00 PM{% elif hour == 21 %}9:00 PM{% elif hour == 22 %}10:00 PM{% endif %}
                            {% endif %}
                        </div>
                        <div style="flex-grow: 1;">
                            <input 
                                type="text" 
                                class="task-input" 
                                placeholder="Enter your task or appointment..."
                                value="{{ task.task_text|default:'' }}"
                                data-task-id="{{ task.id }}"
                                data-hour="{{ hour }}"
                            >
                            <div class="save-status text-success" style="opacity: 0; font-size: 12px; margin-top: 5px;">
                                <i class="fas fa-check me-1"></i>Saved
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>

        <!-- Instructions -->
        <div class="alert alert-info mt-4">
            <i class="fas fa-info-circle me-2"></i>
            <strong>How to use:</strong> Click on any time slot and start typing your task. Changes are automatically saved as you type.
        </div>
    </div>
</div>

{% endblock %}